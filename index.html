<!DOCTYPE html> 
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR-Code Scanner</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="styles.css">
    <script src="https://unpkg.com/html5-qrcode/minified/html5-qrcode.min.js"></script>
</head>
<body>

    <!-- Menüleiste -->
    <header>
        <button id="menuButton">☰ Menü</button>
        <img src="Logo entwurf1.jpg" alt="Logo entwurf1" id="headerImage">
    </header>

    <!-- Kamera öffnen Hinweis -->
    <main>
        <div class="text-container">
            <!-- Hier kannst du den Text einfügen -->
            <p>VU mit mehreren PKW und Personen. Bei Eintreffen an der Einsatzstelle zeigt sich ein Szenario von mehreren Verletzten. Diese können im und um den PKW sein. Die Einsatzstelle ist keinen weiteren Gefahren ausgesetzt.</p>
        </div>

        <div class="camera-container">
            <button id="cameraButton">Patienten scannen</button>
        </div>

        <video id="video" autoplay playsinline></video>
    </main>

    <!-- Modal für Menü -->
    <div id="menuModal" class="modal">
        <div class="modal-content">
            <span class="close">×</span>
            <h2>Menü</h2>
            <ul>
                <li><a href="patient1.html">Patient1</a></li>
                <li><a href="patient2.html">Patient2</a></li>
                <li><a href="patient3.html">Patient3</a></li>
                <li><a href="patient4.html">Patient4</a></li>
                <li><a href="patient5.html">Patient5</a></li>
                <li><a href="patient6.html">Patient6</a></li>
                <li><a href="patient7.html">Patient7</a></li>
                <li><a href="Einstellungen.html">Einstellungen</a></li>
                <li><a href="#about">Über uns</a></li>
            </ul>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const cameraButton = document.getElementById("cameraButton");
            const video = document.getElementById("video");

            const menuButton = document.getElementById("menuButton");
            const menuModal = document.getElementById("menuModal");
            const closeButton = document.querySelector(".close");

            // Menü öffnen und schließen
            menuButton.onclick = function() {
                menuModal.style.display = "block";
            };
            closeButton.onclick = function() {
                menuModal.style.display = "none";
            };
            window.onclick = function(event) {
                if (event.target == menuModal) {
                    menuModal.style.display = "none";
                }
            };

            // Kamera starten
            cameraButton.onclick = async function() {
                try {
                    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                        alert("Die Kamera-API wird von diesem Gerät nicht unterstützt.");
                        return;
                    }

                    // Vollbildmodus aktivieren
                    video.style.position = "fixed";
                    video.style.top = 0;
                    video.style.left = 0;
                    video.style.width = "100vw";
                    video.style.height = "100vh";
                    video.style.zIndex = 1000;

                    // Kamera-Stream starten
                    const stream = await navigator.mediaDevices.getUserMedia({
                        video: {
                            facingMode: "environment" // Rückkamera bevorzugt
                        }
                    });

                    video.srcObject = stream;

                    // QR-Code Scanner aktivieren
                    const html5QrCode = new Html5Qrcode("video");

                    // QR-Code scannen
                    html5QrCode.start(
                        { facingMode: "environment" }, 
                        {
                            fps: 10, 
                            qrbox: 250 
                        },
                        (decodedText, decodedResult) => {
                            // Wenn QR-Code erkannt wird
                            console.log(decodedText);
                            window.location.href = decodedText; // Weiterleiten zur URL aus dem QR-Code
                        },
                        (errorMessage) => {
                            // Optional: Fehlerbehandlung
                            console.warn(errorMessage);
                        }
                    );

                } catch (error) {
                    console.error("Kamera-Zugriff fehlgeschlagen:", error);
                    alert("Kamera-Zugriff fehlgeschlagen. Bitte Berechtigungen prüfen.");
                }
            };
        });
    </script>

    <!-- CSS -->
    <style>
        /* Basislayout */
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0;
            padding: 0;
            background-color: #d3d3d3; /* Hintergrundfarbe */
        }

        header {
            width: 100%;
            padding: 20px;
            background-color: #52576e;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center; /* Zentriert den Inhalt horizontal */
            position: relative; /* Ermöglicht das Positionieren des Menüs absolut */
        }

        #menuButton {
            font-size: 1.5em;
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            position: absolute;
            left: 20px; /* Positioniert den Menübutton am linken Rand */
        }

        #headerImage {
            height: 60px;
        }

        main {
            margin-top: 20px;
            text-align: center;
            width: 100%;
        }

        .text-container {
            margin-bottom: 20px; /* Abstand zwischen Text und Kamera-Button */
            font-size: 1.1em;
            color: white; /* Weißer Text */
            padding: 10px;
            border: 2px solid #52576e; /* Rahmen mit passender Farbe */
            border-radius: 10px; /* Abgerundete Ecken */
            background-color: #333; /* Hintergrundfarbe für den Textbereich */
            width: 80%;
            max-width: 600px;
            transition: all 0.3s ease; /* Übergangseffekt bei Hover */
        }

        .text-container:hover {
            background-color: #52576e; /* Hintergrundfarbe beim Hover */
            color: #fff; /* Textfarbe beim Hover */
            transform: scale(1.05); /* Leicht vergrößern beim Hover */
        }

        .camera-container {
            background-color: #d3d3d3;
            padding: 20px;
            border-radius: 10px;
            display: inline-block;
        }

        #cameraButton {
            padding: 20px 40px;
            font-size: 1.5em;
            background-color: rgb(75, 78, 119);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            width: 80%; /* Vergrößert den Button */
            max-width: 400px; /* Begrenzte Breite */
        }

        video {
            margin-top: 10px;
            width: 100%;
            max-width: 400px;
            height: auto;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            padding-top: 60px;
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 20px;
            border-radius: 10px;
        }

        /* Anpassungen für das Untermenü */
        .modal-content a {
            color: rgb(75, 78, 119); /* Buttonfarbe angepasst */
            font-size: 1.2em;
            padding: 10px;
            display: block;
            text-decoration: none;
            transition: background-color 0.3s ease;
        }

        .modal-content a:hover {
            background-color: rgb(75, 78, 119); /* Hover-Effekt */
            color: white;
        }
    </style>

</body>
</html>
